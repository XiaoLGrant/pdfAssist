<%- include('partials/header') -%>
<%- include('partials/navbarLoggedIn') -%>

    <section class="p-5 bg-primary text-light">
        <div class="container">
            <h1>Account Overview</h1>
            <p class="lead">Welcome, <%= userInfo[0].userName %>!</p>
        </div>
    </section>

    <section class="p-5 bg-light">
        <div class="container rounded-3 p-4 bg-body">
            <h2>Return Address</h2>
            <address>
                <%= userInfo[0].businessName %><br>
                Address: <%= userInfo[0].address1 %>,
                <% if(userInfo[0].address2 !== '') {%>
                    <%= userInfo[0].address2 %>,
                <% } %>
                <%= userInfo[0].city %>, <%= userInfo[0].state %> <%= userInfo[0].zip %><br>
                <% if(userInfo[0].phone !== '') {%>
                    Phone: <%= userInfo[0].phone %><br><br>
                <% } %>
                <% if(userInfo[0].returnAddress2 !== '') {%>
                    <% userInfo[0].returnAddress2.split('\n').forEach(line => { %>
                        <%= line %><br>
                    <% }) %>
                <% } %>
            </address>
            <a href="/user/<%= userInfo[0]._id %>">Edit</a>
        </div>
    </section>

    <section class="p-2 bg-light">
        <div class="container rounded-3 p-4 bg-body">
            <h2>Customers</h2>
            <div>
                <h3>Add A Customer</h3>
                <form action="/dashboard/addCustomer" method="POST" id="addCustomerContact">
                    <div class="row">
                        <div class="col">
                            <label for="addCustomerName">Name</label>
                            <input type="text" class="form-control" name="customerName" id="addCustomerName">
                        </div>
                        <div class="col">
                            <label for="customerEmail">Email</label>
                            <input type="email" class="form-control" name="customerEmail" id="customerEmail">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="inputAddress">Address</label>
                            <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" name="address1" aria-describedby="addressHelp">
                        </div>
                        <div class="col">
                            <label for="inputAddress2">Address 2</label>
                            <input type="text" class="form-control" id="inputAddress2" placeholder="Apartment, studio, or floor" name="address2">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="inputCity">City</label>
                            <input type="text" class="form-control" id="inputCity" name="city">
                        </div>
                        <div class="col-md-2">
                            <label for="inputState">State</label>
                            <input type="text" class="form-control" id="inputState" maxlength="2" name="state">
                        </div>
                        <div class="col-md-4">
                            <label for="inputZip">Zip</label>
                            <input type="text" class="form-control" id="inputZip" maxlength="5" name="zip">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <input class="btn btn-secondary btn-sm my-2" type="submit">
                        </div>
                    </div>
                </form>
            </div>
            <div class="my-3">
                <h3>Current Customers</h3>
                <table class="table">
                    <tbody>
                        <% customerList.forEach(customer => { %>
                            <tr data-id="<%=customer._id%>">
                                <td>
                                    <span><%= customer.customerName %></span>
                                </td>
                                <td>
                                    <span><%= customer.email %></span>
                                </td>
                                <td>
                                   <%= customer.address1 %>,
                                    <% if(customer.address2 !== '') {%>
                                        <%= customer.address2 %>,
                                    <% } %>
                                    <%= customer.city %>, <%= customer.state %> <%= customer.zip %>
                                </td>
                                <td>
                                    <a href="/customer/<%= customer._id %>" class="btn btn-secondary"><i class="fa-regular fa-pen-to-square"></i></a>
                                    <form class="d-inline-block" action="/customer/delete/<%= customer._id %>?_method=DELETE" method="POST">
                                        <button class="btn btn-primary" type="submit"><i class="fa-regular fa-trash-can"></i></button>
                                    </form>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div> 
        </div>
    </section>

    <!-- <div id="api-instructions">
        <h2>API Instructions</h2>
        <p>Use https://legal-docs-generator.herokuapp.com/summons/countyName&tier to view a json file containing data for a summons template.</p>
        <p>Route parameters are:
            <ul>
                <li>County Name: replace countyName with the county's name</li>
                <li>Filing Tier: replace tier with the filing tier-- sc for small claims, cc for county civil, ca for circuit</li>
            </ul>
            Example: <a href="https://legal-docs-generator.herokuapp.com/summons/alachua&cc">https://legal-docs-generator.herokuapp.com/summons/alachua&cc</a>
        </p>
    </div> -->
    
    <script src="https://cdn.tiny.cloud/1/nf56djxmrt5h0sf7j8vkhscwakqvwdeyi7ftriugdec5tc05/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    
<%- include('partials/footer') -%>